(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4137"],{"4Pm/":function(t,e,n){"use strict";n.r(e);var a=n("gDS+"),o=n.n(a),r=n("ktGI"),i=n("SMMm"),c=(n("u8Kd"),n("DSeF"),{name:"happyReadList",components:{pageNum:i.a},data:function(){return{novels:[],categorys:[],keyWord:{title:"",categoryId:""},currentNovel:{},totalNum:null,pageNo:1,pageSize:10,tabHeader:{"background-color":"#F4F4F4",color:"#666666","border-top":"1px solid #BBBBBB","border-bottom":"1px solid #BBBBBB","font-size":"16px","text-align":"center"},isShow:!1,isInderminate:!0,checkAll:!1,choosenCategory:[]}},filters:{formatCategoryInfo:function(t){return t.map(function(t){return t.name}).join("|")}},methods:{sizeChangeFn:function(t){this.pageSize=t,this.fetchNovels()},currentPageChange:function(t){this.pageNo=t,this.fetchNovels()},addNovel:function(){this.$router.push({name:"happyReadAdd"})},close:function(){this.isShow=!1},edit:function(t,e){this.currentNovel=JSON.parse(o()(e)),this.choosenCategory=this.currentNovel.categoryInfo.length?this.currentNovel.categoryInfo.map(function(t){return t.id}):[],this.isShow=!0},checkAllChange:function(t){this.isInderminate=!1,this.choosenCategory=t?this.categorys.map(function(t){return t.id}):[]},onSubmit:function(){var t=this;if(!this.choosenCategory||!this.choosenCategory.length)return this.$wran("请选中类目");var e=this.novels.findIndex(function(e){return e.id===t.currentNovel.id});Object(r.f)({noteId:this.currentNovel.id,categories:this.choosenCategory}).then(function(n){if(n.data.code)return n.data.message&&t.$wran(n.data.message);t.$success("操作成功"),t.close(),Object(r.c)(t.currentNovel.id).then(function(n){if(n.data.code)return n.data.message&&t.$wran(n.data.message);n.data.data&&(t.currentNovel.categoryInfo=n.data.data.length?n.data.data:[],t.$set(t.novels,e,t.currentNovel))})})},del:function(t,e){var n=this;Object(r.a)(e.id).then(function(t){if(t.data.code)return t.data.message&&n.$wran(t.data.message);n.$success("操作成功"),n.fetchNovels()})},fetchNovels:function(){var t=this,e={pageNum:this.pageNo,pageSize:this.pageSize||10},n=this.keyWord;n.title&&(e.title=n.title),n.categoryId&&(e.categoryId=n.categoryId),Object(r.d)(e).then(function(e){if(e.data.code)return e.data.message&&t.$wran(e.data.message);if(e.data.data){t.totalNum=e.data.data.total;var n=e.data.data.records;t.novels=n&&n.length?n:[]}})},search:function(t){var e=this;this.$refs[t].validate(function(t){t&&(e.pageNo=1,e.fetchNovels())})}},created:function(){var t=this;this.fetchNovels(),Object(r.b)().then(function(e){if(e.data.code)return e.data.message&&t.$wran(e.data.message);e.data.data&&(t.categorys=e.data.data.length?e.data.data:[])})}}),s=(n("e1EU"),n("KHd+")),l=Object(s.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",[n("el-form",{ref:"searchForm",attrs:{inline:!0,model:t.keyWord}},[n("el-button",{attrs:{type:"success"},on:{click:t.addNovel}},[t._v("添加小说")]),t._v(" "),n("el-form-item",[n("el-input",{attrs:{placeholder:"输入小说标题",clearable:""},model:{value:t.keyWord.title,callback:function(e){t.$set(t.keyWord,"title","string"==typeof e?e.trim():e)},expression:"keyWord.title"}})],1),t._v(" "),n("el-form-item",[n("el-select",{attrs:{clearable:"",placeholder:"请选择类目"},model:{value:t.keyWord.categoryId,callback:function(e){t.$set(t.keyWord,"categoryId",e)},expression:"keyWord.categoryId"}},t._l(t.categorys,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.search("searchForm")}}},[t._v("搜索")])],1)],1),t._v(" "),n("el-table",{staticClass:"table-box",attrs:{border:"",data:t.novels,"header-cell-style":t.tabHeader}},[n("el-table-column",{attrs:{align:"center",prop:"title",label:"小说标题"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"cover",label:"小说封面"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{staticClass:"gallery-img",attrs:{src:t.row.cover,alt:""}})]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"author",label:"小说作者"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"introduction",label:"小说简介"}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"类目"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatCategoryInfo")(e.row.categoryInfo)))]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){t.edit(e.$index,e.row)}}},[t._v("编辑类目")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){t.del(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("div",{staticClass:"pageNumBox"},[n("pageNum",{attrs:{currentPage:t.pageNo,pageSize:t.pageSize,total:t.totalNum},on:{sizeChange:t.sizeChangeFn,currentChange:t.currentPageChange}})],1),t._v(" "),n("el-dialog",{attrs:{title:"类目选择",visible:t.isShow,width:"30%"},on:{"update:visible":function(e){t.isShow=e}}},[n("el-checkbox",{attrs:{indeterminate:t.isInderminate},on:{change:t.checkAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),t._v(" "),n("el-checkbox-group",{staticClass:"checkbox-group",model:{value:t.choosenCategory,callback:function(e){t.choosenCategory=e},expression:"choosenCategory"}},t._l(t.categorys,function(e){return n("el-checkbox",{key:e.id,staticStyle:{width:"19.5%"},attrs:{label:e.id}},[t._v(t._s(e.name))])})),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.close}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确定")])],1)],1)],1)},[],!1,null,"1723b65b",null);l.options.__file="index.vue";e.default=l.exports},"7jfb":function(t,e,n){},"8wxe":function(t,e,n){},DSeF:function(t,e,n){"use strict";var a={name:"Dialog_BOX",components:{},props:{isShow:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{type:String,default:"50%"}},computed:{},data:function(){return{}},methods:{cancelFn:function(){this.$emit("cancelFn")},confirmFn:function(){this.$emit("confirmFn")}},created:function(){}},o=(n("E9Le"),n("KHd+")),r=Object(o.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:t.title,visible:t.isShow,"close-on-click-modal":!1,"show-close":!1,width:t.width},on:{"update:visible":function(e){t.isShow=e}}},[t._t("del"),t._v(" "),t._t("sort"),t._v(" "),t._t("upload"),t._v(" "),t._t("transfer"),t._v(" "),t._t("default"),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelFn}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmFn}},[t._v("确 定")])],1)],2)},[],!1,null,"7a6bf8ca",null);r.options.__file="index.vue";e.a=r.exports},E9Le:function(t,e,n){"use strict";var a=n("8wxe");n.n(a).a},SMMm:function(t,e,n){"use strict";var a=n("Uwh3"),o={props:{currentPage:{type:Number},pageSizes:{type:Array,default:function(){return[]}},pageSize:{type:Number},total:{type:Number}},components:{},data:function(){return{isShow:!1}},watch:{total:function(t){console.log("total",t),0!=t&&(this.isShow=!0)}},methods:{handleSizeChange:function(t){Object(a.c)("currentSize",t);var e=Object(a.b)("currentSize");this.$emit("sizeChange",e)},handleCurrentChange:function(t){Object(a.c)("currentPage",t);var e=Object(a.b)("currentPage");this.$emit("currentChange",e)}},mounted:function(){},updated:function(){console.log("分页组件",this.currentPage),console.log("分页组件",this.pageSize)},created:function(){}},r=(n("jTOu"),n("KHd+")),i=Object(r.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pageBox"},[this.isShow?e("el-pagination",{attrs:{"current-page":this.currentPage,pageSizes:[5,10,50,100,200,300,400,500],"page-size":this.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}}):this._e()],1)},[],!1,null,"63f271cb",null);i.options.__file="index.vue";e.a=i.exports},dt8s:function(t,e,n){},e1EU:function(t,e,n){"use strict";var a=n("dt8s");n.n(a).a},jTOu:function(t,e,n){"use strict";var a=n("7jfb");n.n(a).a},ktGI:function(t,e,n){"use strict";n.d(e,"e",function(){return l}),n.d(e,"d",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"f",function(){return c}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return r});var a=n("+WsE");function o(t){return t.categoryId=t.categoryId||0,t.pageSize=t.pageSize||10,a.a.post("happyRead/notes",t)}function r(){return a.a.get("happyRead/category")}function i(t){return a.a.del("happyRead/note/"+t)}function c(t){return a.a.post("happyRead/categoryNoteRelation",t)}function s(t){return a.a.post("happyRead/noteCategoryRelation/"+t)}function l(t){return a.a.post("happyRead/note",t)}},u8Kd:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o});var a="https://upload.my51share.com/pic",o="https://upload.my51share.com/file"}}]);