(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8e9c"],{"4Pm/":function(e,t,n){"use strict";n.r(t);var a=n("gDS+"),o=n.n(a),r=n("ktGI"),i=n("SMMm"),c=(n("u8Kd"),n("DSeF"),{name:"happyReadList",components:{pageNum:i.a},data:function(){return{novels:[],categorys:[],keyWord:{title:"",categoryId:""},currentNovel:{},totalNum:null,pageNo:1,pageSize:10,tabHeader:{"background-color":"#F4F4F4",color:"#666666","border-top":"1px solid #BBBBBB","border-bottom":"1px solid #BBBBBB","font-size":"16px","text-align":"center"},isShow:!1,isInderminate:!0,checkAll:!1,choosenCategory:[]}},filters:{formatCategoryInfo:function(e){return e.map(function(e){return e.name}).join("|")}},methods:{sizeChangeFn:function(e){this.pageSize=e,this.fetchNovels()},currentPageChange:function(e){this.pageNo=e,this.fetchNovels()},addNovel:function(){this.$router.push({name:"happyReadAdd"})},close:function(){this.isShow=!1},edit:function(e,t){this.currentNovel=JSON.parse(o()(t)),this.choosenCategory=this.currentNovel.categoryInfo.length?this.currentNovel.categoryInfo.map(function(e){return e.id}):[],this.isShow=!0},checkAllChange:function(e){this.isInderminate=!1,this.choosenCategory=e?this.categorys.map(function(e){return e.id}):[]},onSubmit:function(){var e=this;if(!this.choosenCategory||!this.choosenCategory.length)return this.$wran("请选中类目");var t=this.novels.findIndex(function(t){return t.id===e.currentNovel.id});Object(r.f)({noteId:this.currentNovel.id,categories:this.choosenCategory}).then(function(n){if(n.data.code)return n.data.message&&e.$wran(n.data.message);e.$success("操作成功"),e.close(),Object(r.c)(e.currentNovel.id).then(function(n){if(n.data.code)return n.data.message&&e.$wran(n.data.message);n.data.data&&(e.currentNovel.categoryInfo=n.data.data.length?n.data.data:[],e.$set(e.novels,t,e.currentNovel))})})},del:function(e,t){var n=this;Object(r.a)(t.id).then(function(e){if(e.data.code)return e.data.message&&n.$wran(e.data.message);n.$success("操作成功"),n.fetchNovels()})},fetchNovels:function(){var e=this,t={pageNum:this.pageNo,pageSize:this.pageSize||10},n=this.keyWord;n.title&&(t.title=n.title),n.categoryId&&(t.categoryId=n.categoryId),Object(r.d)(t).then(function(t){if(t.data.code)return t.data.message&&e.$wran(t.data.message);if(t.data.data){e.totalNum=t.data.data.total;var n=t.data.data.records;e.novels=n&&n.length?n:[]}})},search:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.pageNo=1,t.fetchNovels())})}},created:function(){var e=this;this.fetchNovels(),Object(r.b)().then(function(t){if(t.data.code)return t.data.message&&e.$wran(t.data.message);t.data.data&&(e.categorys=t.data.data.length?t.data.data:[])})}}),s=(n("e1EU"),n("KHd+")),l=Object(s.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.keyWord}},[n("el-button",{attrs:{type:"success"},on:{click:e.addNovel}},[e._v("添加小说")]),e._v(" "),n("el-form-item",[n("el-input",{attrs:{placeholder:"输入小说标题",clearable:""},model:{value:e.keyWord.title,callback:function(t){e.$set(e.keyWord,"title","string"==typeof t?t.trim():t)},expression:"keyWord.title"}})],1),e._v(" "),n("el-form-item",[n("el-select",{attrs:{clearable:"",placeholder:"请选择类目"},model:{value:e.keyWord.categoryId,callback:function(t){e.$set(e.keyWord,"categoryId",t)},expression:"keyWord.categoryId"}},e._l(e.categorys,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.search("searchForm")}}},[e._v("搜索")])],1)],1),e._v(" "),n("el-table",{staticClass:"table-box",attrs:{border:"",data:e.novels,"header-cell-style":e.tabHeader}},[n("el-table-column",{attrs:{align:"center",prop:"title",label:"小说标题"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"cover",label:"小说封面"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("img",{staticClass:"gallery-img",attrs:{src:e.row.cover,alt:""}})]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"author",label:"小说作者"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"introduction",label:"小说简介"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"类目"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatCategoryInfo")(t.row.categoryInfo)))]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){e.edit(t.$index,t.row)}}},[e._v("编辑类目")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){e.del(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("div",{staticClass:"pageNumBox"},[n("pageNum",{attrs:{currentPage:e.pageNo,pageSize:e.pageSize,total:e.totalNum},on:{sizeChange:e.sizeChangeFn,currentChange:e.currentPageChange}})],1),e._v(" "),n("el-dialog",{attrs:{title:"类目选择",visible:e.isShow,width:"30%"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-checkbox",{attrs:{indeterminate:e.isInderminate},on:{change:e.checkAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),n("el-checkbox-group",{staticClass:"checkbox-group",model:{value:e.choosenCategory,callback:function(t){e.choosenCategory=t},expression:"choosenCategory"}},e._l(e.categorys,function(t){return n("el-checkbox",{key:t.id,staticStyle:{width:"19.5%"},attrs:{label:t.id}},[e._v(e._s(t.name))])})),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.close}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")])],1)],1)],1)},[],!1,null,"1723b65b",null);l.options.__file="index.vue";t.default=l.exports},"8wxe":function(e,t,n){},DSeF:function(e,t,n){"use strict";var a={name:"Dialog_BOX",components:{},props:{isShow:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{type:String,default:"50%"}},computed:{},data:function(){return{}},methods:{cancelFn:function(){this.$emit("cancelFn")},confirmFn:function(){this.$emit("confirmFn")}},created:function(){}},o=(n("E9Le"),n("KHd+")),r=Object(o.a)(a,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.title,visible:e.isShow,"close-on-click-modal":!1,"show-close":!1,width:e.width},on:{"update:visible":function(t){e.isShow=t}}},[e._t("del"),e._v(" "),e._t("sort"),e._v(" "),e._t("upload"),e._v(" "),e._t("transfer"),e._v(" "),e._t("default"),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancelFn}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmFn}},[e._v("确 定")])],1)],2)},[],!1,null,"7a6bf8ca",null);r.options.__file="index.vue";t.a=r.exports},DmZD:function(e,t,n){},E9Le:function(e,t,n){"use strict";var a=n("8wxe");n.n(a).a},JHrQ:function(e,t,n){"use strict";var a=n("DmZD");n.n(a).a},SMMm:function(e,t,n){"use strict";var a=n("Uwh3"),o={props:{currentPage:{type:Number},pageSizes:{type:Array,default:function(){return[]}},pageSize:{type:Number},total:{type:Number}},components:{},data:function(){return{isShow:!1}},watch:{total:function(e){console.log("total",e),0!=e&&(this.isShow=!0)}},methods:{handleSizeChange:function(e){Object(a.c)("currentSize",e);var t=Object(a.b)("currentSize");this.$emit("sizeChange",t)},handleCurrentChange:function(e){Object(a.c)("currentPage",e);var t=Object(a.b)("currentPage");this.$emit("currentChange",t)}},mounted:function(){},updated:function(){console.log("分页组件",this.currentPage),console.log("分页组件",this.pageSize)},created:function(){}},r=(n("JHrQ"),n("KHd+")),i=Object(r.a)(o,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pageBox"},[this.isShow?t("el-pagination",{attrs:{"current-page":this.currentPage,pageSizes:[10,50,100,200,300,400,500],"page-size":this.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}}):this._e()],1)},[],!1,null,"0db06f42",null);i.options.__file="index.vue";t.a=i.exports},dt8s:function(e,t,n){},e1EU:function(e,t,n){"use strict";var a=n("dt8s");n.n(a).a},ktGI:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"f",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return r});var a=n("+WsE");function o(e){return e.categoryId=e.categoryId||0,e.pageSize=e.pageSize||10,a.a.post("happyRead/notes",e)}function r(){return a.a.get("happyRead/category")}function i(e){return a.a.del("happyRead/note/"+e)}function c(e){return a.a.post("happyRead/categoryNoteRelation",e)}function s(e){return a.a.post("happyRead/noteCategoryRelation/"+e)}function l(e){return a.a.post("happyRead/note",e)}},u8Kd:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="https://www.my51share.com/boss/upload"}}]);