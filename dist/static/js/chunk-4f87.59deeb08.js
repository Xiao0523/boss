(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4f87"],{"0Afi":function(t,e,n){"use strict";var i=n("B2JU");n.n(i).a},"6rjU":function(t,e,n){},"7eBp":function(t,e,n){"use strict";var i=n("cDtl");n.n(i).a},"8vJh":function(t,e,n){},B2JU:function(t,e,n){},BPVh:function(t,e,n){"use strict";var i=n("PRqM");n.n(i).a},DSeF:function(t,e,n){"use strict";var i={name:"Dialog_BOX",components:{},props:{isShow:{type:Boolean,default:!1},title:{type:String,default:"提示"},width:{type:String,default:"50%"}},computed:{},data:function(){return{}},methods:{cancelFn:function(){this.$emit("cancelFn")},confirmFn:function(){this.$emit("confirmFn")}},created:function(){}},a=(n("0Afi"),n("KHd+")),s=Object(a.a)(i,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:t.title,visible:t.isShow,"close-on-click-modal":!1,"show-close":!1,width:t.width},on:{"update:visible":function(e){t.isShow=e}}},[t._t("del"),t._v(" "),t._t("sort"),t._v(" "),t._t("upload"),t._v(" "),t._t("transfer"),t._v(" "),t._t("default"),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelFn}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmFn}},[t._v("确 定")])],1)],2)},[],!1,null,"abb9f780",null);s.options.__file="index.vue";e.a=s.exports},EEiy:function(t,e,n){},PRqM:function(t,e,n){},SMMm:function(t,e,n){"use strict";var i=n("Uwh3"),a={props:{currentPage:{type:Number},pageSizes:{type:Array,default:function(){return[]}},pageSize:{type:Number},total:{type:Number}},components:{},data:function(){return{isShow:!1}},watch:{total:function(t){console.log("total",t),0!=t&&(this.isShow=!0)}},methods:{handleSizeChange:function(t){Object(i.c)("currentSize",t);var e=Object(i.b)("currentSize");this.$emit("sizeChange",e)},handleCurrentChange:function(t){Object(i.c)("currentPage",t);var e=Object(i.b)("currentPage");this.$emit("currentChange",e)}},mounted:function(){},updated:function(){console.log("分页组件",this.currentPage),console.log("分页组件",this.pageSize)},created:function(){}},s=(n("XCpr"),n("KHd+")),o=Object(s.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pageBox"},[this.isShow?e("el-pagination",{attrs:{"current-page":this.currentPage,pageSizes:[10,50,100,200,300,400,500],"page-size":this.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}}):this._e()],1)},[],!1,null,"21d651f8",null);o.options.__file="index.vue";e.a=o.exports},XCpr:function(t,e,n){"use strict";var i=n("EEiy");n.n(i).a},YBlO:function(t,e,n){"use strict";var i=n("6rjU");n.n(i).a},ZOHz:function(t,e,n){"use strict";var i=n("DSeF"),a={name:"searchNav",props:{from:{type:String},ids:{type:Array}},components:{menusDialog:i.a},computed:{userInfo:function(){return this.$store.getters.userInfo}},data:function(){return{inputText:"",tagId:"",startDate:"",endDate:"",visible:!1,moreBtnText:"",generateAdvflag:!1,generateTagflag:!1,dialogTitle:"",advList:[],tagList:[],titles:[],transferData:[],selectTransfer:[],dropdown:[{id:0,text:"批量关联广告"},{id:1,text:"批量关联标签"}]}},watch:{},methods:{selectedtTagFn:function(t){this.tagId=t},generateData:function(){if("批量关联广告"==this.moreBtnText)for(var t=this.advList.length,e=0;e<t;e++){var n=this.advList[e];console.log(n.id),this.transferData.push({key:n.id,label:n.title})}else if("批量关联标签"==this.moreBtnText)for(var i=this.tagList.length,a=0;a<i;a++){var s=this.tagList[a];this.transferData.push({key:s.id,label:s.cName})}},transferChange:function(t,e,n){console.log(t,e,n),"right"==e&&(this.selectTransfer=n)},moreFn:function(t){console.log("文章ids",this.ids),this.moreBtnText=t,this.visible=!0,this.selectTransfer=[],"批量关联广告"!=t&&this.generateAdvflag?"批量关联标签"!=t&&this.generateTagflag||(this.dialogTitle="请选择要关联的标签",this.titles=["所有标签列表","关联标签列表"],this.transferData=[],this.generateData(),this.generateTagflag=!0):(this.dialogTitle="请选择要关联的广告",this.titles=["所有广告列表","关联广告列表"],this.transferData=[],this.generateData(),this.generateAdvflag=!0)},confirmFn:function(){"批量关联广告"==this.moreBtnText?this.relevanceAdvs():"批量关联标签"==this.moreBtnText&&this.relevanceTags()},addFn:function(){switch(this.from){case"ArticleList":this.$router.push("/ArticleManager/ArticleAdd");break;case"AppList":this.$router.push("/AppManager/AppAdd");break;case"reportList":this.$router.push("/reportsManager/reportsAdd")}},delsFn:function(){this.$emit("delsFn")},searchFn:function(){var t=this,e={},n="";switch(this.from){case"ArticleList":n="fuzzySearchHuoDong";break;case"AppList":n="selectAppByTitle";break;case"reportList":n="selectbaodaobytitle"}this.inputText&&(e.key=this.inputText),this.tagId&&(e.tagId=this.tagId),this.startDate&&(e.startDay=this.startDate),this.endDate&&(e.endDay=this.endDate),e.pageNum=1,e.pageSize=10,this.$req.post(n,e).then(function(n){t.$emit("searchFn",n,e)}).catch(function(t){console.log(t)})},relevanceAdvs:function(){var t=this;0!=this.ids.length&&0!=this.selectTransfer.length&&this.$req.post("ContactArticleAndAdvertisement",{advertisementIds:this.selectTransfer,articleIds:this.ids}).then(function(e){t.$success("关联广告成功"),t.$emit("relevanceFn"),t.visible=!1}).catch(function(t){console.log(t)})},relevanceTags:function(){var t=this;if(0!=this.ids.length&&0!=this.selectTransfer.length){var e=JSON.parse(this.userInfo).realname;this.$req.post("ContactArticleAndTag",{tagIds:this.selectTransfer,articleIds:this.ids,creator:e}).then(function(e){t.$success("关联标签成功"),t.$emit("relevanceFn"),t.visible=!1}).catch(function(t){console.log(t)})}},getAdvFn:function(){var t=this;this.$req.get("v2/shareAdv/1/999").then(function(e){t.advList=e.data.data.records}).catch(function(t){console.log(t)})},getTagFn:function(){var t=this;this.$req.get("v2/shareCategory/1/999").then(function(e){t.tagList=e.data.data.records}).catch(function(t){console.log(t)})}},created:function(){switch(this.from){case"ArticleList":this.text="文章标题",this.placeholder="请输入文章标题",this.btnText="添加文章";break;case"AppList":this.text="应用名",this.placeholder="请输入应用名",this.btnText="添加应用";break;case"reportList":this.text="报道标题",this.placeholder="请输入报道标题",this.btnText="添加报道"}this.getAdvFn(),this.getTagFn()}},s=(n("7eBp"),n("KHd+")),o=Object(s.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:5}},[n("div",{staticClass:"input-box"},[n("span",[t._v(t._s(t.text))]),t._v(" "),n("el-input",{staticClass:"input",attrs:{placeholder:t.placeholder,clearable:""},model:{value:t.inputText,callback:function(e){t.inputText=e},expression:"inputText"}})],1)]),t._v(" "),"ArticleList"==t.from?n("el-col",{attrs:{span:5}},[n("el-select",{attrs:{clearable:"",placeholder:"请选择标签"},model:{value:t.tagId,callback:function(e){t.tagId=e},expression:"tagId"}},t._l(t.tagList,function(t){return n("el-option",{key:t.id,attrs:{label:t.cName,value:t.id}})}))],1):t._e(),t._v(" "),"ArticleList"!==t.from?n("el-col",{attrs:{span:9}},[n("div",{staticClass:"date-box"},[n("span",[t._v("日期")]),t._v(" "),n("el-date-picker",{attrs:{type:"datetime",placeholder:"开始日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),n("el-date-picker",{attrs:{type:"datetime",placeholder:"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)]):t._e(),t._v(" "),n("el-col",{attrs:{span:6}},[n("div",[n("el-button",{attrs:{type:"success"},on:{click:t.searchFn}},[t._v("搜索")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.addFn}},[t._v(t._s(t.btnText))]),t._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:t.delsFn}},[t._v("批量删除")])],1)])],1),t._v(" "),n("el-dropdown",[n("el-button",{attrs:{type:"primary"}},[t._v("\n      更多"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.dropdown,function(e){return n("el-dropdown-item",{key:e.id,nativeOn:{click:function(n){t.moreFn(e.text)}}},[t._v(t._s(e.text))])}))],1),t._v(" "),n("menusDialog",{attrs:{isShow:t.visible,title:t.dialogTitle},on:{cancelFn:function(e){t.visible=!1},confirmFn:t.confirmFn}},[n("el-transfer",{attrs:{data:t.transferData,titles:t.titles,"button-texts":["移除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"}},on:{change:t.transferChange},model:{value:t.selectTransfer,callback:function(e){t.selectTransfer=e},expression:"selectTransfer"}})],1)],1)},[],!1,null,"88694322",null);o.options.__file="index.vue";e.a=o.exports},cDtl:function(t,e,n){},pBta:function(t,e,n){"use strict";n.r(e);var i=n("QbLZ"),a=n.n(i),s=n("ZOHz"),o=n("DSeF"),r=n("SMMm"),l={name:"addRole",components:{},props:{source:{type:String},form:{type:Object,default:function(){return{roleKey:"",roleName:""}}},dialogFormVisible:{type:Boolean,default:!1},type:{type:String,default:""}},computed:{title:function(){return"add"==this.type?"添加角色":"更新角色"}},data:function(){return{formLabelWidth:"120px"}},methods:{confirmFn:function(){this.$emit("addRoleFn",this.form)},cancelFn:function(){this.$emit("cancelFn")}},watch:{form:{handler:function(t,e){console.log(t)},deep:!0}},created:function(){}},c=(n("YBlO"),n("KHd+")),u=Object(c.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:t.title,visible:t.dialogFormVisible,"show-close":!1,modal:!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("el-form",{attrs:{model:t.form}},[n("el-form-item",{attrs:{label:"角色名key","label-width":t.formLabelWidth}},[n("el-input",{attrs:{"auto-complete":"off",required:"required"},model:{value:t.form.roleKey,callback:function(e){t.$set(t.form,"roleKey",e)},expression:"form.roleKey"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"角色名","label-width":t.formLabelWidth}},[n("el-input",{attrs:{"auto-complete":"off",required:"required"},model:{value:t.form.roleName,callback:function(e){t.$set(t.form,"roleName",e)},expression:"form.roleName"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelFn}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmFn}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"65391c24",null);u.options.__file="index.vue";var d=u.exports,h={props:{dialogMenuVisible:{type:Boolean,default:!1},roleId:{type:Number}},data:function(){return{menuList:[],menuIds:[],checkAll:!1,isIndeterminate:!0,isShow:!1}},watch:{dialogMenuVisible:function(t){var e=this;this.isShow=t,1==t&&this.$route.query.userId&&this.$req.get("menu/"+this.$route.query.userId).then(function(t){t.data.data.map(function(t,n){for(var i=0;i<e.menuList.length;i++)if(t===e.menuList[i].url){e.menuIds.push(e.menuList[i].id);break}})})}},methods:{cancelMenuFn:function(){this.$emit("cancelMenuFn")},confirmMenuFn:function(){0==this.menuIds.length?this.$alert("您还未选择相关菜单","提交失败",{type:"error"}):this.$emit("confirmMenuFn",this.menuIds)},handleMenuIdsChange:function(t){},handleCheckAllChange:function(t){var e=this.menuList.map(function(t){return t.id});this.menuIds=t?e:[],this.isIndeterminate=!1},close:function(){this.$emit("cancelMenuFn")}},created:function(){var t=this;this.$req.get("v2.1/auth/menus").then(function(e){t.menuList=e.data.data})}},f=(n("BPVh"),Object(c.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:"菜单权限管理",visible:t.isShow,width:"30%"},on:{"update:visible":function(e){t.isShow=e},close:t.close}},[n("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),t._v(" "),n("el-checkbox-group",{staticStyle:{display:"flex","flex-wrap":"wrap"},on:{change:t.handleMenuIdsChange},model:{value:t.menuIds,callback:function(e){t.menuIds=e},expression:"menuIds"}},t._l(t.menuList,function(e,i){return n("el-checkbox",{key:i,staticStyle:{width:"19.5%"},attrs:{label:e.id}},[t._v(t._s(e.name))])})),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.cancelMenuFn}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.confirmMenuFn}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"584979ac",null));f.options.__file="index.vue";var p=f.exports,m=n("L2JU"),g={name:"permissionsList",components:{searchNav:s.a,Dialog:o.a,pageNum:r.a,addRole:d,editMenuDialog:p},computed:a()({userInfo:function(){return this.$store.getters.userInfo}},Object(m.b)(["roleIds","adminIds"])),data:function(){return{query:{},isShowRevRolesBtn:!1,addRoleDialogVisible:!1,getRowKeys:function(t){return t.id},form:{},type:"",listData:[],tableIdArr:[],ids:[],userByRoles:[],delId:Number,startDate:"",endDate:"",totalNum:null,pageNo:1,pageSize:10,visible:!1,tabHeader:{"background-color":"#F4F4F4",color:"#666666","border-top":"1px solid #BBBBBB","border-bottom":"1px solid #BBBBBB","font-size":"16px","text-align":"center"},roleId:null,isEditMenu:!1}},filters:{typeStatus:function(t){return 0==t?"文章":1==t?"APP":"未知"},statusFilter:function(t){return 0==t?"未启用":1==t?"启用":"未知"}},methods:a()({},Object(m.c)(["set_roleIds"]),{setSelectRow:function(){if(this.tableIdArr.length)for(var t=0;t<this.tableIdArr.length;t++)for(var e=0;e<this.userByRoles.length;e++)this.tableIdArr[t]==this.userByRoles[e]&&void 0!=this.$refs.multipleTable&&this.$refs.multipleTable.toggleRowSelection(this.listData[t],!0)},setOperaFn:function(){if(!this.ids.length)return this.$wran("请先勾选角色");this.$router.push({path:"/operationManager/operationList"})},reSetFn:function(){this.$refs.multipleTable.clearSelection()},backFn:function(){this.$router.go(-1)},revRolesFn:function(){var t=this;if(!this.roleIds.length)return this.$wran("请先勾选角色");this.$req.post("v2.1/auth/user4role",{roleIds:this.roleIds,userIds:this.adminIds}).then(function(e){t.$success(e.data.message)}).catch(function(t){console.log(t)})},handleOpera:function(t,e){var n=[];if(n.push(e.id),this.ids=n,this.set_roleIds(this.ids),!this.ids.length)return this.$wran("请先勾选角色");this.$router.push({path:"/operationManager/operationList",query:{roleId:e.id}})},addFn:function(){this.type="add",this.addRoleDialogVisible=!0},addRoleFn:function(t){var e=this,n="",i={roleKey:t.roleKey,roleName:t.roleName};"add"==this.type?(n="v2.1/auth/role",this.$req.post(n,i).then(function(t){e.$success(t.data.message),e.addRoleDialogVisible=!1,e.form={},e.initData()}).catch(function(t){console.log(t)})):(n="v2.1/auth/role",i.id=t.id,this.$req.patch(n,i).then(function(t){e.$success(t.data.message),e.addRoleDialogVisible=!1,e.initData()}).catch(function(t){console.log(t)}))},sizeChangeFn:function(t){this.pageSize=t,this.initData()},currentChangeFn:function(t){this.pageNo=t,this.initData()},searchFn:function(t){this.appList=t.data.data},confirmFn:function(){var t=this;this.visible=!1,this.$req.del("/v2.1/auth/role/"+this.delId).then(function(e){t.$success(e.data.message),t.initData()}).catch(function(t){console.log(t)})},SelectionChange:function(t){this.ids=t.map(function(t){return t.id}),this.set_roleIds(this.ids)},changeFn:function(t,e,n){var i=this,a=JSON.parse(this.userInfo).realname,s={id:n.id,isShow:t,updateBy:a};this.$req.post("updateAppRemind",s).then(function(t){i.$success("修改成功")}).catch(function(t){return console.log(t)})},handleEdit:function(t,e){console.log(t,e),this.addRoleDialogVisible=!0,this.type="edit",this.form=e},handleDelete:function(t,e){this.visible=!0;var n=[];n.push(e.id),this.ids=n,this.delId=e.id},initData:function(){var t=this;this.$req.get("v2.1/auth/role").then(function(e){console.log(e.data),t.listData=e.data.data,t.tableIdArr=t.listData.map(function(t){return t.id}),setTimeout(function(){t.setSelectRow()},500)}).catch(function(t){console.log(t)})},getRoleIdsByUserIdFn:function(){var t=this;this.$req.get("v2.1/auth/getRoleIdsByUserId/"+this.query.userId).then(function(e){t.userByRoles=e.data.data,console.log("用户角色",e.data.data)}).catch(function(t){console.log(t)})},handleMenu:function(t,e){this.isEditMenu=!0,this.roleId=e.id},cancelMenuFn:function(){this.isEditMenu=!1},confirmMenuFn:function(t){var e=this;this.isEditMenu=!1,this.$req.post("v2.1/auth/menus",{menuIds:t,roleId:this.roleId}).then(function(t){0==t.data.code?e.$success("提交成功"):e.$message.error("提交失败")})}}),beforeRouteEnter:function(t,e,n){n(function(t){"/adminManager/adminList"==e.path&&(t.isShowRevRolesBtn=!0)})},watch:{},created:function(){this.initData(),this.query=this.$route.query,this.query.userId&&this.getRoleIdsByUserIdFn()}},v=(n("qFTk"),Object(c.a)(g,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:20}},[n("el-button",{attrs:{type:"primary"},on:{click:t.addFn}},[t._v("添加角色")]),t._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:t.reSetFn}},[t._v("重置")])],1)],1),t._v(" "),n("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"end"}},[n("el-button",{attrs:{type:"warning"},on:{click:t.setOperaFn}},[t._v("批量设置操作")]),t._v(" "),t.isShowRevRolesBtn?n("el-button",{attrs:{type:"warning"},on:{click:t.revRolesFn}},[t._v("关联角色")]):t._e(),t._v(" "),t.isShowRevRolesBtn?n("el-button",{attrs:{type:"info"},on:{click:t.backFn}},[t._v("返回")]):t._e()],1),t._v(" "),n("el-table",{ref:"multipleTable",staticClass:"table-box",staticStyle:{width:"100%"},attrs:{data:t.listData,"empty-text":"暂无数据",border:"","max-height":"700","row-key":t.getRowKeys,"header-cell-style":t.tabHeader},on:{"selection-change":t.SelectionChange}},[n("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"55"}}),t._v(" "),n("el-table-column",{attrs:{prop:"roleName",label:"角色名"}}),t._v(" "),n("el-table-column",{attrs:{prop:"roleKey",label:"角色key"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建时间",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("p",[t._v(t._s(t._f("formatDate")(e.row.createTime)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"operation-box"},[n("el-button",{attrs:{size:"mini"},on:{click:function(n){t.handleEdit(e.$index,e.row)}}},[t._v("更新")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){t.handleDelete(e.$index,e.row)}}},[t._v("删除")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(n){t.handleOpera(e.$index,e.row)}}},[t._v("设置操作")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){t.handleMenu(e.$index,e.row)}}},[t._v("菜单权限")])],1)]}}])})],1),t._v(" "),n("div",{staticClass:"pageNumBox"},[n("pageNum",{attrs:{currentPage:t.pageNo,pageSize:t.pageSize,total:t.totalNum},on:{sizeChange:t.sizeChangeFn,currentChange:t.currentChangeFn}})],1),t._v(" "),n("addRole",{attrs:{dialogFormVisible:t.addRoleDialogVisible,form:t.form,type:t.type},on:{addRoleFn:t.addRoleFn,cancelFn:function(e){t.addRoleDialogVisible=!1}}}),t._v(" "),n("Dialog",{attrs:{isShow:t.visible},on:{cancelFn:function(e){t.visible=!1},confirmFn:t.confirmFn}},[n("span",{attrs:{slot:"del"},slot:"del"},[t._v("删除操作不可恢复，确认删除？")])]),t._v(" "),n("editMenuDialog",{attrs:{dialogMenuVisible:t.isEditMenu,roleId:t.roleId},on:{cancelMenuFn:t.cancelMenuFn,confirmMenuFn:t.confirmMenuFn}})],1)},[],!1,null,"636fc586",null));v.options.__file="index.vue";e.default=v.exports},qFTk:function(t,e,n){"use strict";var i=n("8vJh");n.n(i).a}}]);